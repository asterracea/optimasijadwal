{% extends 'layout.html' %}
{% block title %} Hasil Jadwal {% endblock %}
{% block content %}
  <div class="container mx-auto p-4 bg-white shadow-lg">
  <h1 class="text-2xl font-bold text-[#003b73] mb-4">Lihat Hasil Jadwal</h1>

  <form method="POST" action="{{ url_for('data_hasil') }}" class="mb-6 flex items-center gap-4">
    <label for="id_generate" class="text-[#003b73] ">Pilih ID Generate:</label>
    <select name="id_generate" id="id_generate" class="p-2 border border-gray-300 rounded">
      <option value="">-- Pilih --</option>
      {% for item in opsi_ids %}
        <option value="{{ item.id_generate }}" {% if selected_id == item.id_generate|string %}selected{% endif %}>
          {{ item.id_generate }}
        </option>
      {% endfor %}
    </select>
    <button type="submit" class="px-4 py-2 bg-[#003b73]  text-white rounded hover:bg-indigo-700">Tampilkan</button>
  </form>

  {% if jadwals|length > 0 %}
    <table class="min-w-full bg-white shadow border">
      <thead class="bg-[#003b73] text-white text-sm">
        <tr>
          <th class="px-4 py-2">No</th>
          <th class="px-4 py-2">Hari</th>          
          <th class="px-4 py-2">Ruang</th>          
          <th class="px-4 py-2">Mata kuliah</th>
          <th class="px-4 py-2">Waktu Mulai</th>
          <th class="px-4 py-2">Waktu Selesai</th>
          <th class="px-4 py-2">Kelas</th>
          <th class="px-4 py-2">Semester</th>
          <th class="px-4 py-2">Dosen</th>
          <th class="px-4 py-2">sks</th>
          <th class="px-4 py-2">Prodi</th>


        </tr>
      </thead>
      <tbody>
        {% for jadwal in jadwals %}
        <tr class="border-b hover:bg-gray-100 text-sm">
          <td class="px-4 py-2">{{ loop.index }}</td>
          <td class="px-4 py-2">{{ jadwal.hari }}</td>
          <td class="px-4 py-2">{{ jadwal.ruang }}</td>
          <td class="px-4 py-2">{{ jadwal.mata_kuliah }}</td>
          <td class="px-4 py-2">{{ jadwal.waktu_mulai }}</td>
          <td class="px-4 py-2">{{ jadwal.waktu_selesai }}</td>
          <td class="px-4 py-2">{{ jadwal.kelas }}</td>          
          <td class="px-4 py-2">{{ jadwal.nama_semester }}</td>   
          <td class="px-4 py-2">{{ jadwal.nama_dosen }}</td>
          <td class="px-4 py-2">{{ jadwal.sks }}</td>                 
          <td class="px-4 py-2">{{ jadwal.nama_prodi }}</td>
          
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% if bentrok and bentrok|length > 0 %}
    <div class="mt-6 p-4 bg-red-100 border border-red-400 rounded text-red-800">
      <h2 class="font-semibold mb-2">Ditemukan {{ bentrok|length }} bentrok jadwal!</h2>
      <ul class="list-disc pl-5 text-sm">
        {% for b in bentrok %}
          <li>
            [{{ b.hari }}] Dosen <strong>{{ b.nama_dosen }}</strong> atau Ruang <strong>{{ b.ruang }}</strong> bentrok antara 
            {{ b.waktu_mulai }}-{{ b.waktu_selesai }} dan {{ b.b_mulai }}-{{ b.b_selesai }}
          </li>
        {% endfor %}
      </ul>
    </div>
    {% else %}
    <div class="mt-6 p-4 bg-green-100 border border-green-400 rounded text-green-800">
      Tidak ada bentrok jadwal untuk ID Generate <strong>{{ selected_id }}</strong>.
    </div>
    {% endif %}
  {% elif selected_id %}
    <p class="text-red-500">Tidak ada data untuk ID Generate {{ selected_id }}</p>
  {% endif %}
</div>

{% endblock %}
        
